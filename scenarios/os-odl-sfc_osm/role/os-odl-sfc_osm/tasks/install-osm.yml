---
# SPDX-license-identifier: Apache-2.0
##############################################################################
# Copyright (c) 2018 Ericsson AB and others.
# All rights reserved. This program and the accompanying materials
# are made available under the terms of the Apache License, Version 2.0
# which accompanies this distribution, and is available at
# http://www.apache.org/licenses/LICENSE-2.0
##############################################################################

- name: get OSM installer {{ osm_release_version }}
  become_user: "{{ osm_install_user }}"
  become: yes
  get_url:
    url: "https://osm-download.etsi.org/ftp/{{ osm_release_version }}/install_osm.sh"
    dest: "/home/{{ osm_install_user }}/install_osm.sh"
    mode: u+x

- name: install OSM
  become_user: "{{ osm_install_user }}"
  become: yes
  command: "/bin/bash ./install_osm.sh --nolxd -y "
  args:
    chdir: "/home/{{ osm_install_user }}"
    creates: "/usr/bin/osm"

- name: create osmrc file
  copy:
    dest: "{{ osmrc_file_dest }}"
    content: |
      export OSM_HOSTNAME=127.0.0.1
      export OSM_OL005=True
